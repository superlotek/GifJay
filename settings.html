<!doctype html>
<html class="no-js" lang="">
  <head>
    <title>GifJay : Settings</title>

    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="guts/css/styles.css" media="all" rel="stylesheet" />

    <script src="guts/js/jquery-2.1.4.min.js"></script>
    <script src="guts/js/mousetrap.min.js"></script>
    <script src="guts/js/keydrown.js"></script>
    <script src="settings.js"></script>
    <script src="guts/js/Inits.js"></script>
    <script src="guts/js/Keyboard.js"></script>
    <script src="guts/js/Midi.js"></script>
    <script src="guts/js/Scene.js"></script>
    <script src="guts/js/Play.js"></script>
    <script src="guts/js/Overlays.js"></script>
    <script src="guts/js/Filter.js"></script>
    <script src="guts/js/Effects.js"></script>
    <script src="guts/js/Text.js"></script>
    <script src="playlist.js"></script>

    <style>

        body { padding: 20px; }
        input[type=checkbox]{
            height: 0;
            width: 0;
            visibility: hidden;
        }

        label {
            cursor: pointer;
            text-indent: -9999px;
            width: 200px;
            height: 100px;
            background: grey;
            display: block;
            border-radius: 100px;
            position: relative;
        }

        label:after {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            width: 90px;
            height: 90px;
            background: #fff;
            border-radius: 90px;
            transition: 0.3s;
        }

        input:checked + label {
            background: #bada55;
        }

        input:checked + label:after {
            left: calc(100% - 5px);
            transform: translateX(-100%);
        }

        label:active:after {
            width: 130px;
        }
        h1 { text-align: center; }
        h3 { font-size: 14px; text-align: right; }
        td { padding: 0 10px; }
        input[type='range'] { width: 100%; }
    </style>

  </head>

  <body>
    <h1>Settings</h1>

    <table style="margin: 0 auto;">
        <tr>
            <td><h3>Beat Time:</h3></td>
            <td><input type="range" id="beatTime-slider" name="volume" value="2000" step="100" min="100" max="10000"></td>
            <td><span id="beatTime"></span></td>
        </tr>
        <tr>
            <td><h3>BarTender Length:</h3></td>
            <td><input type="range" id="barLength-slider" name="barlength" value="8" step="2" min="0" max="64"></td>
            <td><span id="barLength"></span></td>
        </tr>
        <tr>
            <td><h3>BeatTime Threshold Minimum:</h3</td>
            <td><input type="range" id="beatTimeMinimum-slider" name="beatTimeMinimum" value="1000" step="10" min="0" max="1000"></td>
            <td><span id="beatTimeMinimum"></span></td>
        </tr>
        <tr>
            <td><h3>Startup Bank Number:</h3></td>
            <td><input type="range" id="startupBankNumber-slider" name="startupBankNumber" value="0" step="1" min="0"></td>
            <td><span id="startupBankNumber"></span></td>
        </tr>
        <tr>
            <td><h3>Saturation Amount:</h3></td>
            <td><input type="range" id="saturationAmount-slider" name="saturation" value="50" step="1" min="0" max="128"></td>
            <td><span id="saturationAmount"></span></td>
        </tr>
        <tr>
            <td><h3>Overlay Frequency:</h3></td>
            <td><input type="range" id="overlayFrequency-slider" name="overlayFrequency" value="64" step="8" min="0" max="96"></td>
            <td><span id="overlayFrequency"></span></td>
        </tr>
        <tr>
            <td><h3>Overlay Duration:</h3></td>
            <td><input type="range" id="overlayDuration-slider" name="overlayDuration" value="4" step="4" min="0" max="80"></td>
            <td><span id="overlayDuration"></span></td>
        </tr>
        <tr>
            <td><h3>Color Palette Opacity:</h3></td>
            <td><input type="range" id="colorPaletteOpacity-slider" name="colorPaletteOpacity" value=".25" step=".01" min="0" max=".9"></td>
            <td><span id="colorPaletteOpacity"></span></td>
        </tr>
        <tr>
            <td>
                <h3 id="performanceMode">Performance Mode: <span></span></h3>
                <input type="checkbox" id="perf-check" onchange="doalert(this)" /><label for="perf-check">Performance Mode</label>
            </td>
            <td>
                <h3 id="overlayTexture">Overlay Texture: <span></span></h3>
                <input type="checkbox" id="texture-check" onchange="doalert2(this)" /><label for="texture-check">Overlay Texture</label>
            </td>
            <td>
                <h3 id="overlayTexture">Random Overlays: <span></span></h3>
                <input type="checkbox" id="randomOverlay-check" onchange="doalert3(this)" /><label for="randomOverlay-check">Random Overlays</label>
            </td>
        </tr>
        <tr>
            <td><button id="save-btn">Save settings</button></td>
            <td><button id="clear-btn">Clear settings</button></td>
        </tr>
    </table>

    
    <div id="demo"></div><br>

    <script>


        $(document).ready(function() {
            var glerp = enabledBanksArray.length - 1;
            console.log('glerp ', glerp);
            $('#startupBankNumber-slider').attr('max', glerp);

            // var glub = enabledBanksArray.filter(function(glerp) {
            // return glerp.id === startupBankNumber;
            // });

        var gleeep = enabledBanksArray.findIndex( x => x.id === bankNumber);

        // CHECK FOR LOCAL STORAGE
        // ======================================
        if (!localStorage.length) { console.log('Nothing in Storage'); }

        $('span#beatTime').text(beatTime);
        $('#beatTime-slider').val(beatTime );
        $('span#barLength').text(barLength);
        $('#barLength-slider').val(barLength );

        $('span#beatTimeMinimum').text(beatTimeMinimum);
        $('#beatTimeMinimum-slider').val(beatTimeMinimum );
        $('span#saturationAmount').text(saturationAmount);
        $('#saturationAmount-slider').val(saturationAmount );
        $('span#overlayFrequency').text(overlayFrequency);
        $('#overlayFrequency-slider').val(overlayFrequency );
        $('span#overlayDuration').text(overlayDuration);
        $('#overlayDuration-slider').val(overlayDuration );

        $('span#startupBankNumber').text(startupBankNumber + " : " + enabledBanksArray[gleeep].trigger.toUpperCase() + " : " + enabledBanksArray[gleeep].name);
        $('#startupBankNumber-slider').val(startupBankNumber);

        $('span#colorPaletteOpacity').text(colorPaletteOpacity);
        $('#colorPaletteOpacity-slider').val(colorPaletteOpacity);

        if (performanceModeOn === true) {
            $('#perf-check').prop('checked', true)
        }

        if (overlayTextureOn === true) {
            $('#texture-check').prop('checked', true)
        }

        if (randomOverlayOn === true) {
            $('#randomOverlay-check').prop('checked', true)
        }


        $('#beatTime-slider').attr('value', localStorage.getItem('beatTime') );
        $("#beatTime-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider = document.getElementById("beatTime-slider");
        // var output = document.getElementById("demo");

        $('#barLength-slider').attr('value', localStorage.getItem('barTenderLength') );
        $("#barLength-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider2 = document.getElementById("barLength-slider");

        $('#saturationAmount-slider').attr('value', localStorage.getItem('saturationAmount') );
        $("#saturationAmount-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider3 = document.getElementById("saturationAmount-slider");

        $('#startupBankNumber-slider').attr('value', localStorage.getItem('startupBankNumber') );
        $("#startupBankNumber-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider4 = document.getElementById("startupBankNumber-slider");

        $('#colorPaletteOpacity-slider').attr('value', localStorage.getItem('colorPaletteOpacity') );
        $("#colorPaletteOpacity-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider5 = document.getElementById("colorPaletteOpacity-slider");

        $('#overlayFrequency-slider').attr('value', localStorage.getItem('overlayFrequency') );
        $("#overlayFrequency-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider6 = document.getElementById("overlayFrequency-slider");
        
        $('#overlayDuration-slider').attr('value', localStorage.getItem('overlayDuration') );
        $("#overlayDuration-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider7 = document.getElementById("overlayDuration-slider");

        $('#beatTimeMinimum-slider').attr('value', localStorage.getItem('beatTimeMinimum') );
        $("#beatTimeMinimum-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider8 = document.getElementById("beatTimeMinimum-slider");

        // output.innerHTML = slider.value; // Display the default slider value

        // Update the current slider value (each time you drag the slider handle)
        slider.oninput = function() {
          // output.innerHTML = this.value;
           $('span#beatTime').text(this.value);
        }
        slider2.oninput = function() {
           $('span#barLength').text(this.value);
        }

        slider3.oninput = function() {
           $('span#saturationAmount').text(this.value);
        }
        slider4.oninput = function() {
           $('span#startupBankNumber').text(this.value + " : " + enabledBanksArray[this.value].trigger.toUpperCase() + " : " + enabledBanksArray[this.value].name);
        }

        slider5.oninput = function() {
           $('span#colorPaletteOpacity').text(this.value);
        }

        slider6.oninput = function() {
           $('span#overlayFrequency').text(this.value);
        }
        slider7.oninput = function() {
           $('span#overlayDuration').text(this.value);
        }
        slider8.oninput = function() {
           $('span#beatTimeMinimum').text(this.value);
        }

                // SAVE / CLEAR SETTINGS
        // ======================================
        $('#save-btn').on('click', function() {
            console.log('settings saved');
            localStorage.setItem('performanceMode', JSON.parse(performanceModeOn));
            localStorage.setItem('overlayTexture', JSON.parse(overlayTextureOn));
            localStorage.setItem('randomOverlay', JSON.parse(randomOverlayOn));
            localStorage.setItem('beatTime', slider.value);
            localStorage.setItem('barTenderLength', slider2.value);
            localStorage.setItem('saturationAmount', slider3.value);
            localStorage.setItem('startupBankNumber', JSON.parse(enabledBanksArray[slider4.value].id));
            localStorage.setItem('colorPaletteOpacity', slider5.value);
            localStorage.setItem('overlayFrequency', slider6.value);
            localStorage.setItem('overlayDuration', slider7.value);
            localStorage.setItem('beatTimeMinimum', slider8.value);
        });

        $('#clear-btn').on('click', function() {
            console.log('settings cleared');
            localStorage.clear();

        });



        });



        // CHECK FOR CHECKBOX
        // ======================================
        function doalert(checkboxElem) {
          if (checkboxElem.checked) {
            console.log("checked");
            performanceModeOn = true;
          } else {
            console.log("unchecked");
            performanceModeOn = false;
          }
        }

        function doalert2(checkboxElem) {
          if (checkboxElem.checked) {
            console.log("checked");
            overlayTextureOn = true;
          } else {
            console.log("unchecked");
            overlayTextureOn = false;
          }
        }

        function doalert3(checkboxElem) {
          if (checkboxElem.checked) {
            console.log("checked");
            randomOverlayOn = true;
          } else {
            console.log("unchecked");
            randomOverlayOn = false;
          }
        }






    </script>
  </body>
</html>
