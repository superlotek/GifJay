<!doctype html>
<html class="no-js" lang="">
  <head>
    <title>GifJay : Settings</title>

    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="guts/css/styles.css" media="all" rel="stylesheet" />

    <script src="guts/js/jquery-2.1.4.min.js"></script>
    <script src="guts/js/mousetrap.min.js"></script>
    <script src="guts/js/keydrown.js"></script>
    <script src="settings.js"></script>
    <script src="guts/js/Inits.js"></script>
    <script src="guts/js/Keyboard.js"></script>
    <script src="guts/js/Midi.js"></script>
    <script src="guts/js/Scene.js"></script>
    <script src="guts/js/Play.js"></script>
    <script src="guts/js/Overlays.js"></script>
    <script src="guts/js/Filter.js"></script>
    <script src="guts/js/Effects.js"></script>
    <script src="guts/js/Text.js"></script>
    <script src="playlist.js"></script>

    <style>
        input[type=checkbox]{
            height: 0;
            width: 0;
            visibility: hidden;
        }

        label {
            cursor: pointer;
            text-indent: -9999px;
            width: 200px;
            height: 100px;
            background: grey;
            display: block;
            border-radius: 100px;
            position: relative;
        }

        label:after {
            content: '';
            position: absolute;
            top: 5px;
            left: 5px;
            width: 90px;
            height: 90px;
            background: #fff;
            border-radius: 90px;
            transition: 0.3s;
        }

        input:checked + label {
            background: #bada55;
        }

        input:checked + label:after {
            left: calc(100% - 5px);
            transform: translateX(-100%);
        }

        label:active:after {
            width: 130px;
        }
    </style>

  </head>

  <body>
    <h1>Settings</h1>

    <h3 id="beatTime">Beat Time: <span></span></h3>
    <input type="range" id="beatTime-slider" name="volume" value="2000" step="100" min="100" max="10000">
    <div id="demo"></div><br>

    <h3 id="barLength">BarTender Length: <span></span></h3>
    <input type="range" id="barLength-slider" name="barlength" value="8" step="2" min="0" max="64">

    <h3 id="startupBankNumber">Startup Bank Number: <span></span></h3>
    <input type="range" id="startupBankNumber-slider" name="startupBankNumber" value="18" step="1" min="0" max="25">

    <h3 id="saturationAmount">Saturation Amount: <span></span></h3>
    <input type="range" id="saturationAmount-slider" name="saturation" value="50" step="1" min="0" max="128">

    <h3 id="colorPaletteOpacity">Color Palette Opacity: <span></span></h3>
    <input type="range" id="colorPaletteOpacity-slider" name="colorPaletteOpacity" value=".25" step=".01" min="0" max=".9">


    <h3 id="performanceMode">Performance Mode: <span></span></h3>
<!--     <input type="checkbox" id="perf-check" onchange="doalert(this)">
 -->    <input type="checkbox" id="perf-check" onchange="doalert(this)" /><label for="perf-check">Performance Mode</label>

    <h3 id="overlayTexture">Overlay Texture: <span></span></h3>
<!--     <input type="checkbox" id="perf-check" onchange="doalert(this)">
 -->    <input type="checkbox" id="texture-check" onchange="doalert2(this)" /><label for="texture-check">Overlay Texture</label>


    <div>
        <button id="save-btn">Save settings</button>
        <button id="clear-btn">Clear settings</button>
    </div>

    <script>

        // CHECK FOR LOCAL STORAGE
        // ======================================
        if (!localStorage.length) { console.log('Nothing in Storage'); }

        $('#beatTime span').text(beatTime);
        $('#beatTime-slider').val(beatTime );
        $('#barLength span').text(barLength);
        $('#barLength-slider').val(barLength );
        $('#saturationAmount span').text(saturationAmount);
        $('#saturationAmount-slider').val(saturationAmount );
        $('#startupBankNumber span').text(startupBankNumber + " : " + playlist.bank[startupBankNumber].trigger.toUpperCase() + " : " + playlist.bank[startupBankNumber].name);
        $('#startupBankNumber-slider').val(startupBankNumber);
        $('#colorPaletteOpacity span').text(colorPaletteOpacity);
        $('#colorPaletteOpacity-slider').val(colorPaletteOpacity);

        if (performanceModeOn === true) {
            $('#perf-check').prop('checked', true)
        }

        if (overlayTextureOn === true) {
            $('#texture-check').prop('checked', true)
        }

        // CHECK FOR CHECKBOX
        // ======================================
        function doalert(checkboxElem) {
          if (checkboxElem.checked) {
            console.log("checked");
            performanceModeOn = true;
          } else {
            console.log("unchecked");
            performanceModeOn = false;
          }
        }

        function doalert2(checkboxElem) {
          if (checkboxElem.checked) {
            console.log("checked");
            overlayTextureOn = true;
          } else {
            console.log("unchecked");
            overlayTextureOn = false;
          }
        }

        $('#beatTime-slider').attr('value', localStorage.getItem('beatTime') );
        $("#beatTime-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider = document.getElementById("beatTime-slider");
        // var output = document.getElementById("demo");

        $('#barLength-slider').attr('value', localStorage.getItem('barTenderLength') );
        $("#barLength-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider2 = document.getElementById("barLength-slider");

        $('#saturationAmount-slider').attr('value', localStorage.getItem('saturationAmount') );
        $("#saturationAmount-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider3 = document.getElementById("saturationAmount-slider");

        $('#startupBankNumber-slider').attr('value', localStorage.getItem('startupBankNumber') );
        $("#startupBankNumber-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider4 = document.getElementById("startupBankNumber-slider");

        $('#colorPaletteOpacity-slider').attr('value', localStorage.getItem('colorPaletteOpacity') );
        $("#colorPaletteOpacity-slider").on("input change", function() { console.log($(this).attr('value')); } );
        var slider5 = document.getElementById("colorPaletteOpacity-slider");




        // output.innerHTML = slider.value; // Display the default slider value

        // Update the current slider value (each time you drag the slider handle)
        slider.oninput = function() {
          // output.innerHTML = this.value;
           $('#beatTime span').text(this.value);
        }
        slider2.oninput = function() {
           $('#barLength span').text(this.value);
        }

        slider3.oninput = function() {
           $('#saturationAmount span').text(this.value);
        }
        slider4.oninput = function() {
           $('#startupBankNumber span').text(this.value + " : " + playlist.bank[this.value].trigger.toUpperCase() + " : " + playlist.bank[this.value].name);
        }

        slider5.oninput = function() {
           $('#colorPaletteOpacity span').text(this.value);
        }

        // SAVE / CLEAR SETTINGS
        // ======================================
        $('#save-btn').on('click', function() {
            console.log('settings saved');
            localStorage.setItem('performanceMode', JSON.parse(performanceModeOn));
            localStorage.setItem('overlayTexture', JSON.parse(overlayTextureOn));
            localStorage.setItem('beatTime', slider.value);
            localStorage.setItem('barTenderLength', slider2.value);
            localStorage.setItem('saturationAmount', slider3.value);
            localStorage.setItem('startupBankNumber', slider4.value);
            localStorage.setItem('colorPaletteOpacity', slider5.value);
        });

        $('#clear-btn').on('click', function() {
            console.log('settings cleared');
            localStorage.clear();

        });

    </script>
  </body>
</html>
